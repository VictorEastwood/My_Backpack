# NONLINEAR BACKSTEPPING CONTROL & FEEDBACK LINEARIZATION
# 非线性反步控制与反馈线性化
---
## 1. 系统简介
这个系统是一个典型的质量-弹簧系统，其中包含一个非线性弹簧和一个质量块。让我们重新绘制并解释这个系统。

### 示意图
```
  |---/\/\/\---[m]--->
  |    k       m     F
```

### 系统解释

1. **质量块 \( m \)**：
   - 质量块 \( m \) 可以沿着水平线自由移动。
   - 位置 \( x \) 描述了质量块的位移。

2. **弹簧 \( \alpha \)**：
   - 弹簧连接在固定点和质量块之间。
   - 弹簧具有非线性恢复力，其力与位移的立方成正比，即 \( \alpha x^3 \)。

3. **外力 \( F \)**：
   - 外力 \( F \) 作用在质量块上，推动或拉动质量块。

4. **运动方程**：
   - 系统的运动方程为：
     \[
     m\ddot{x} + \alpha x^3 = F
     \]
   - 其中，\( m \ddot{x} \) 是质量块的惯性力，\( \alpha x^3 \) 是弹簧的恢复力，\( F \) 是外力。

### 解释
- 当外力 \( F \) 作用在质量块上时，质量块会在水平线上移动。
- 弹簧的恢复力与位移的立方成正比，这意味着弹簧的恢复力是非线性的。
- 系统的运动由上述运动方程描述，考虑了质量块的惯性力和弹簧的非线性恢复力。

这个系统的行为可以通过求解运动方程来研究，通常需要使用数值方法来处理非线性方程。

## 2. 非线性反馈线性化

令：
- \( F = u \) 为控制输入 Input
- \( x_1 = x \) 为质量块的位移 Displacement
- \( x_2 = \dot{x} \) 为质量块的速度 Velocity

控制目标为：使质量块的位移 \( x_1 \) 跟踪给定的参考信号 \( x_d \)。
\(x_1 = x_ {1d}\) 时，系统的稳态误差为零。
建立状态空间方程：
$$
\begin{cases}
\dot{x_1} = x_2 \\
\dot{x_2} = \frac{1}{m} (u - \alpha x_1^3)
\end{cases}
$$
这样的系统叫做链式系统

$$
\begin{aligned}
\dot{x_1} &= x_2 \tag{1} \\
\end{aligned}
$$

$$
\begin{aligned}
\dot{x_2} &= \frac{1}{m} (u - \alpha x_1^3) \tag{2}
\end{aligned}
$$
我们引入一个误差函数,目标是使得误差函数收敛到0
$$
\begin{aligned}
e &= x_{1d}-x_1   \tag{3}
\end{aligned}
$$
我们对误差函数求导
$$
\begin{aligned}
\dot{e} &= \dot{x}_{1d}-\dot{x}_1 \\
        &= \dot{x}_{1d}-x_2 \tag{4}
\end{aligned}
$$
所以我们需要找到一个Lyapunov函数$V(e)$,使得
$$
\begin{aligned}
V(e) :PD \\
\dot{V}(e) :ND
\end{aligned}
$$
所以我们设计一个Lyapunov函数
$$
\begin{aligned}
V_1 &= \frac{1}{2}e^2 \tag{5}
\end{aligned}
$$
对Lyapunov函数求导
$$
\begin{aligned}
\dot{V}_1 &= \frac{\partial V_1}{\partial e}\cdot \frac{\partial e}{\partial t} \\
          &= e\dot{e} \\
          &= e(\dot{x}_{1d}-x_2) \tag{6}
\end{aligned}
$$
我们设计$\dot{x}_{1d}-x_2 = -k_1e$
其中$k_1$是一个正定的常数,我们叫它controller gain
我们希望$\dot{V}_1$是负定的，所以我们令
$$
\begin{aligned}
x_{2d} = \dot{x}_{1d}+k_1e \tag{7}
\end{aligned}
$$
我们就有了一个新的目标：$x_2 \rightarrow x_{2d} $
令
$$
\begin{aligned}
\delta  = x_{2d}-x_2 \tag{8}
\end{aligned}
$$

把8式代入6式
$$
\begin{aligned}
\dot{V}_1 &= e(\dot{x}_{1d}-(x_{2d}-\delta)) \\
\end{aligned}
$$
代入7式
$$
\begin{aligned}
\dot{V}_1 &= e(\dot{x}_{1d}-x_{2d}+\delta) \\
          &= e(\dot{x}_{1d}-\dot{x}_{1d}-k_1e+\delta) \\
          &= -k_1e^2 +e\delta \tag{9}
\end{aligned}
$$
对\( \delta \) 求导并代入2式代入4式
$$
\begin{aligned}
\dot{\delta}&= \dot{x}_{2d}-\dot{x}_2 \\
            &= \ddot{x}_{1d}+k_1\dot{e}-\dot{x}_2 \\
            &= \ddot{x}_{1d}+k_1\dot{e}+(-\frac{1}{m}(u-\alpha x_1^3))\\
            &= \ddot{x}_{1d}+k_1(\dot{x}_{1d}-x_2)+(-\frac{1}{m}(u-\alpha x_1^3)) \\
            &= \ddot{x}_{1d}+k_1(\dot{x}_{1d}-x_2)+\frac{\alpha}{m}x_1^3-\frac{1}{m}u\tag{10}
\end{aligned}
$$
所以我们产生了一个新的目标：$\delta \rightarrow 0$并且我们希望$e \rightarrow 0$
所以我们设计一个新的Lyapunov函数包含$e$和$\delta$，满足：
$$
\begin{aligned}
v_{e,\delta} : PD \\
\dot{v}_{e,\delta} : ND
\end{aligned}
$$
故该Lyapunov函数为：
$$
\begin{aligned}
V_2 &= V_1 + \frac{1}{2}\delta^2 
\end{aligned}
$$
对Lyapunov函数求导
$$
\begin{aligned}
\dot{V}_2 &= \dot{V}_1 + \delta\dot{\delta} 
\end{aligned}
$$
代入9式可得：
$$
\begin{aligned}
\dot{V}_2 &= -k_1e^2 +e\delta + \delta\dot{\delta}\\
            &= -k_1e^2 +\delta(e+\dot{\delta})\\
\end{aligned}
$$
由于我们希望$\dot{V}_2$是负定的，并且$-k_1e^2$是负定的，所以我们希望$\delta(e+\dot{\delta})$是负定的，所以我们令
$$
\begin{aligned}
e+\dot{\delta} = -k_2\delta \tag{11}
\end{aligned}
$$
其中$k_2$我们也希望是一个正定的常数，我们叫它controller gain
代入10式
$$
\begin{aligned}
e+\ddot{x}_{1d}+k_1(\dot{x}_{1d}-x_2)+\frac{\alpha}{m}x_1^3-\frac{1}{m}u = -k_2\delta \tag{12}
\end{aligned}
$$
可以推断出
$$
\begin{aligned}
u = me+m\ddot{x}_{1d}+mk_1(\dot{x}_{1d}-x_2)+\alpha x_1^3+mk_2\delta \tag{13}
\end{aligned}
$$
